<!DOCTYPE html>
<html lang="en">
  <head>
    
      <title>Rancher Parte 2 – Instalação e configuração :: Blog Homelaber Brasil |  — Homelab·Infraestrutura de TI· Cloud Computing· DevOps</title>
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="description" content="Olá Homelabers!
Essa é segunda parte da série sobre Rancher.
Se você perdeu a primeira parte, não tem problema! Acesse olink e veja o post e o vídeo com todos os detalhes sobre como fazer a preparação de um servidor Ubuntu, instalando o Docker para receber o Rancher Server, instalar o Rancher Server e configurar a autenticação local.
https://twitter.com/homelaber/status/948835714954915857
Hoje vou mostrar a vocês como:
 * Configurar o Rancher Server * Configurar e adicionar um host local no Rancher * Fazer o deploy de containers  Configurando Environments (Ambientes) no Rancher O que é um ambiente?"/>
<meta name="keywords" content=""/>
<meta name="robots" content="noodp"/>
<link rel="canonical" href="/rancher-parte-2-instalacao-e-configuracao/" />





<link rel="stylesheet" href="/assets/style.css">


<link rel="stylesheet" href="/style.css">


<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/apple-touch-icon-144-precomposed.png">
<link rel="shortcut icon" href="/img/favicon.png">


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Rancher Parte 2 – Instalação e configuração"/>
<meta name="twitter:description" content="Olá Homelabers!
Essa é segunda parte da série sobre Rancher.
Se você perdeu a primeira parte, não tem problema! Acesse olink e veja o post e o vídeo com todos os detalhes sobre como fazer a preparação de um servidor Ubuntu, instalando o Docker para receber o Rancher Server, instalar o Rancher Server e configurar a autenticação local.
https://twitter.com/homelaber/status/948835714954915857
Hoje vou mostrar a vocês como:
 * Configurar o Rancher Server * Configurar e adicionar um host local no Rancher * Fazer o deploy de containers  Configurando Environments (Ambientes) no Rancher O que é um ambiente?"/>



<meta property="og:title" content="Rancher Parte 2 – Instalação e configuração" />
<meta property="og:description" content="Olá Homelabers!
Essa é segunda parte da série sobre Rancher.
Se você perdeu a primeira parte, não tem problema! Acesse olink e veja o post e o vídeo com todos os detalhes sobre como fazer a preparação de um servidor Ubuntu, instalando o Docker para receber o Rancher Server, instalar o Rancher Server e configurar a autenticação local.
https://twitter.com/homelaber/status/948835714954915857
Hoje vou mostrar a vocês como:
 * Configurar o Rancher Server * Configurar e adicionar um host local no Rancher * Fazer o deploy de containers  Configurando Environments (Ambientes) no Rancher O que é um ambiente?" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/rancher-parte-2-instalacao-e-configuracao/" />
<meta property="article:published_time" content="2018-01-08T20:40:23+00:00" />
<meta property="article:modified_time" content="2018-01-08T20:40:23+00:00" /><meta property="og:site_name" content="Blog Homelaber Brasil | " />






  </head>
  <body class="">
    <div class="container">
      <header class="header">
  <span class="header__inner">
    <a href="/" class="logo" style="text-decoration: none;">
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367"/>
</svg>
</span>
    <span class="logo__text">Homelaber Brasil</span>
    <span class="logo__cursor"></span>
  
</a>

    <span class="header__right">
      
        <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/archive">arquivo</a></li>
        
      
        
          <li><a href="/sobre">sobre</a></li>
        
      
        
          <li><a href="https://github.com/valdecircarvalho/">github</a></li>
        
      
        
          <li><a href="https://twitter.com/homelaber">@homelaber</a></li>
        
      
      
    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/archive">arquivo</a></li>
      
    
      
        <li><a href="/sobre">sobre</a></li>
      
    
      
        <li><a href="https://github.com/valdecircarvalho/">github</a></li>
      
    
      
        <li><a href="https://twitter.com/homelaber">@homelaber</a></li>
      
    
  </ul>
</nav>

        <span class="menu-trigger">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M0 0h24v24H0z" fill="none"/>
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
          </svg>
        </span>
      
      <span class="theme-toggle">
        <svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>

      </span>
    </span>
  </span>
</header>


      <div class="content">
        
  <div class="post">
    <h2 class="post-title"><a href="/rancher-parte-2-instalacao-e-configuracao/">Rancher Parte 2 – Instalação e configuração</a></h2>
    <div class="post-meta">
      
        <span class="post-date">
            08-01-2018
        </span>
      
      <span class="post-author">— Written by Valdecir Carvalho</span>
      
        <span class="post-read-time">— 4 min lendo</span>
      
    </div>

    
      <span class="post-tags">
        
          #<a href="/tags/rancher_labs/">@Rancher_Labs</a>&nbsp;
        
          #<a href="/tags//">#k8s</a>&nbsp;
        
          #<a href="/tags//">#kubernetes</a>&nbsp;
        
          #<a href="/tags//">#RancherLabs</a>&nbsp;
        
          #<a href="/tags/awd/">awd</a>&nbsp;
        
          #<a href="/tags/blog/">blog</a>&nbsp;
        
          #<a href="/tags/como-instalar-rancher/">como instalar rancher</a>&nbsp;
        
          #<a href="/tags/container/">container</a>&nbsp;
        
          #<a href="/tags/devops/">devops</a>&nbsp;
        
          #<a href="/tags/docker/">docker</a>&nbsp;
        
          #<a href="/tags/instala%C3%A7%C3%A3o-rancher/">instalação rancher</a>&nbsp;
        
          #<a href="/tags/rancher/">rancher</a>&nbsp;
        
          #<a href="/tags/rancher-labs/">rancher labs</a>&nbsp;
        
          #<a href="/tags/rancheros/">rancheros</a>&nbsp;
        
          #<a href="/tags/tutorial-rancher/">tutorial rancher</a>&nbsp;
        
          #<a href="/tags/vsphere/">vSphere</a>&nbsp;
        
      </span>
    

    

    <div class="post-content">
      <p>Olá Homelabers!</p>
<p>Essa é segunda parte da série sobre Rancher.</p>
<p>Se você perdeu a primeira parte, não tem problema! Acesse o<a href="http://homelaber.com.br/rancher-parte-1-instalacao-e-configuracao/"> link e veja o post e o vídeo com todos os detalhes</a> sobre como fazer a preparação de um servidor Ubuntu, instalando o Docker para receber o Rancher Server, instalar o Rancher Server e configurar a autenticação local.</p>
<p><a href="https://twitter.com/homelaber/status/948835714954915857">https://twitter.com/homelaber/status/948835714954915857</a></p>
<p>Hoje vou mostrar a vocês como:</p>
<pre><code>  * Configurar o Rancher Server
  * Configurar e adicionar um host local no Rancher
  * Fazer o deploy de containers
</code></pre>
<h2 id="configurando-environments-ambientes-no-rancher">Configurando Environments (Ambientes) no Rancher</h2>
<p><strong>O que <strong><strong>é</strong></strong> um <strong><strong>ambiente</strong></strong>?</strong></p>
<p>O Rancher suporta agrupamento de recursos em vários ambientes. Cada um com seu próprio conjunto de serviços e recursos de infraestrutura  gerenciado por um ou mais usuários ou equipes.</p>
<p>Por exemplo, você pode criar ambientes separados de &ldquo;dev&rdquo;, &ldquo;teste&rdquo; e &ldquo;produção&rdquo; para manter as coisas isoladas e dar acesso ao ambiente de &ldquo;dev&rdquo; a todos os desenvolvedores, mas restringir o ambiente de &ldquo;produção” a apenas ao time de produção.</p>
<p><strong>Para configurar um novo ambiente:</strong></p>
<p>Acesse o servidor do Rancher em http://<!-- raw HTML omitted -->:8080</p>
<p>Clique em <strong>Default</strong> &raquo; <strong>Manage Environments</strong> &raquo; <strong>Add Environment</strong></p>
<p>Preencha os campos e clique em <strong>Create</strong></p>
<p><img src="/imagens/2018/01/instalacao-rancher-2-1.jpg" alt="">
<img src="/imagens/2018/01/instalacao-rancher-2-2.jpg" alt="">
<img src="/imagens/2018/01/instalacao-rancher-2-3.jpg" alt=""></p>
<h2 id="adicionando-hosts-no-rancher">Adicionando Hosts no Rancher</h2>
<p>O próximo passo da nossa configuração é adicionar um host &ldquo;local&rdquo; ao Rancher Server.</p>
<p><strong>O que é um host?</strong>
Antes de adicionar seu primeiro serviço ou iniciar um contêiner, você deve <strong>adicionar pelo menos um único host Linux que suporte o Docker e seja capaz de se comunicar com o servidor Rancher via HTTP</strong>. O Rancher suporta a adição de hosts Linux na forma de uma máquina virtual ou física de qualquer fornecedor de nuvem pública, nuvens local ou mesmo em servidores bare metal (físicos).</p>
<p>Em nosso lab, vamos utilizar um servidor Linux Ubuntu Server 16.04. Nesse post não vou mostrar como instalar o Ubuntu, mas <a href="http://homelaber.com.br/como-instalar-e-configurar-o-linux-ubuntu-server/">deixo aqui um link</a> com o passo-a-passo da instalação caso você tenha alguma dúvida.</p>
<p><strong>Instalando o Docker</strong></p>
<p>Antes de adicionar o host ao Rancher, vamos fazer a instalação do Docker utilizando um script de instalação fornecido pelo time da Rancher Labs para instalar o Docker na sua versão correta. Todos os comandos abaixo devem ser executados em seu Rancher Host.</p>
<pre><code>$ sudo curl https://releases.rancher.com/install-docker/17.03.sh | sh
</code></pre>
<p>Esse comando faz o download de um script e inicia a instalação do Docker versão 17.03.</p>
<p><img src="/imagens/2018/01/instalacao-rancher-2-5.jpg" alt=""></p>
<p>Ao final da instalação, você verá a seguinte tela, que mostra que o Docker versão 17.03.2-ce foi instalado e pergunta se você que executar o comando para evitar que você precise digitar “sudo” sempre que for rodando algum comando Docker. Em nosso lab, eu recomendo habilitar essa “funcionalidade” por questões práticas. Mas em seu ambiente de Produção, leia e pesquise sobre os riscos.</p>
<p><img src="/imagens/2018/01/instalacao-rancher-2-6.jpg" alt=""></p>
<pre><code>$ sudo usermod -aG docker $USER
</code></pre>
<p><img src="/imagens/2018/01/instalacao-rancher-2-7.jpg" alt=""></p>
<pre><code>$ docker run hello-world
</code></pre>
<p>Esse comando irá criar um container para que você valide sua instalação. O resultado do comando é o apresentado abaixo:</p>
<p>O próximo passo, é configurar o Docker para inicializar junto com o SO, assim, se a sua VM reiniciar, o Docker será inicializado automaticamente.</p>
<pre><code>$ sudo systemctl enable docker
</code></pre>
<p>**Para adicionar um host local: **</p>
<p>Com o seu host já preparado - Docker instalado e configurado, na tela principal do Rancher Server:</p>
<p>Clique em <strong>Infrastructure</strong> &raquo; <strong>Hosts</strong> &raquo; <strong>Add Host</strong></p>
<p><img src="/imagens/2018/01/instalacao-rancher-2-4.jpg" alt=""></p>
<p>Selecione a opção <strong>Custom</strong> &raquo; <strong>Preencha o IP do servidor host</strong> (192.168.1.41 no exemplo) &raquo; <strong>copie o comando gerado</strong> &raquo; <strong>Close</strong></p>
<p><img src="/imagens/2018/01/instalacao-rancher-2-8.jpg" alt=""></p>
<p>O próximo passo, é executar o comando gerado pelo Rancher em seu host:</p>
<pre><code>sudo docker run -e CATTLE_AGENT_IP=&quot;192.168.1.41&quot; --rm --privileged -v /var/run/docker.sock:/var/run/docker.sock -v /var/lib/rancher:/var/lib/rancher rancher/agent:v1.2.7 http://192.168.1.40:8080/v1/scripts/A8D092E0859FCEEE7D37:1514678400000:bqWHhDgZAxcmaBtZAA7BYECCUsE
</code></pre>
<p>O que esse comando faz é criar um container do Rancher Agent em seu host e apontar para o servidor Rancher.</p>
<p><img src="/imagens/2018/01/instalacao-rancher-2-9.jpg" alt=""></p>
<p>Após alguns minutos, o seu host já deve aparecer no painel do Rancher</p>
<p><img src="/imagens/2018/01/instalacao-rancher-2-10.jpg" alt=""></p>
<h2 id="criando-o-primeiro-container-no-rancher">Criando o primeiro container no Rancher</h2>
<p>Agora que nós já adicionamos o host ao nosso server Rancher, vamos criar um container.</p>
<p>O primeiro passo é clicar em <strong>INFRASTRUCURE</strong> &raquo; <strong>Containers</strong> &raquo; <strong>Add Container</strong> e preencher os campos:</p>
<pre><code>  * **Name**: Nome do container
  * **Description**: Descrição do container
  * **Select Image**: Imagem Docker que você quer utilizar.
  * **Public Host Port**: Porta pública da sua aplicação
  * **Private Container Port**: Porta privada da sua aplicação/container.
</code></pre>
<p><img src="/imagens/2018/01/instalacao-rancher-2-11.jpg" alt="">
<img src="/imagens/2018/01/instalacao-rancher-2-12.jpg" alt=""></p>
<p>Após isso, clique em <strong>Create</strong> e em alguns segundos o seu container estará criado e rodando.</p>
<p><img src="/imagens/2018/01/instalacao-rancher-2-13.jpg" alt=""></p>
<!-- raw HTML omitted -->
<h2 id="próximos-passos">Próximos passos</h2>
<p>Nesse post, falamos sobre a configuração de Environments no Rancher, o setup e preparação de um servidor Ubuntu para se tornar um host Rancher, como adicionar o host ao Rancher e como fazer o deploy de um container simples.</p>
<p>No próximo e último post da série, irei abordar os seguintes assuntos:</p>
<pre><code>  * Provisionar hosts no VMware vSphere.
  * Provisionar hosts na cloud Amazon AWS.
</code></pre>
<p>Bom pessoal, por hoje é isso! No vídeo demonstro mais algumas coisas como o catálogo de aplicações do Rancher e outras dicas. Não deixe de assistir.</p>
<p>[embed]https://youtu.be/Bh7XS51VmTw[/embed]</p>
<p>Deixe ai nos comentários o que você está achando da série! Se você já está colocando em prática o que aprendeu aqui!</p>
<p>Um abraço e até o próximo post!</p>

    </div>
    
      
        <div class="pagination">
          <div class="pagination__title">
            <span class="pagination__title-h">Leia outros posts</span>
            <hr />
          </div>
          <div class="pagination__buttons">
            
              <span class="button previous">
                <a href="/vendo-apple-macbook-pro-15-retina-mid-2015-i7-16gb-512gb-ssd/">
                  <span class="button__icon">←</span>
                  <span class="button__text">(VENDIDO) VENDO Apple Macbook Pro 15 Retina Mid 2015 - i7 | 16GB | 512GB SSD</span>
                </a>
              </span>
            
            
              <span class="button next">
                <a href="/rancher-parte-1-instalacao-e-configuracao/">
                  <span class="button__text">Rancher Parte 1 - Instalação e configuração</span>
                  <span class="button__icon">→</span>
                </a>
              </span>
            
          </div>
        </div>
      
    
    

    
      
        

      
    
    
    </div>

      </div>

      
        <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright copyright--user">2016-2019 - Homelaber Brasil - Valdecir Carvalho</div>
    
  </div>
</footer>

<script src="/assets/main.js"></script>
<script src="/assets/prism.js"></script>


      
    </div>

    
  </body>
</html>
