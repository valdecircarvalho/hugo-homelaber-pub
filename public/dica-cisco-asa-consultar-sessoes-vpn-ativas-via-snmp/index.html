<!DOCTYPE html>
<html lang="en">
  <head>
    
      <title>Dica: Cisco ASA - Consultar sessões VPN ativas via SNMP :: Blog Homelaber Brasil |  — Homelab·Infraestrutura de TI· Cloud Computing· DevOps</title>
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="description" content="Olá Homelabers,
Vou começar a postar mais coisas sobre o meu dia-a-dia na FIRMA. É uma forma de guardar a informação para consultas futuras e ainda ajudar quem está passando pelo mesmo problema agora ou em um futuro distante.
Hoje precisei fazer um monitor no OpManager (a ferramenta de monitoração que utilizamos na firma) que mostrasse o número de sessões VPN ativas no Cisco ASA (Firewall). A idéia é monitorar de uma forma fácil e gráfica quantos usuários estão utilizando a VPN, determinar horários de pico para otimizar a banda de internet, etc."/>
<meta name="keywords" content=""/>
<meta name="robots" content="noodp"/>
<link rel="canonical" href="/dica-cisco-asa-consultar-sessoes-vpn-ativas-via-snmp/" />





<link rel="stylesheet" href="/assets/style.css">


<link rel="stylesheet" href="/style.css">


<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/apple-touch-icon-144-precomposed.png">
<link rel="shortcut icon" href="/img/favicon.png">


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Dica: Cisco ASA - Consultar sessões VPN ativas via SNMP"/>
<meta name="twitter:description" content="Olá Homelabers,
Vou começar a postar mais coisas sobre o meu dia-a-dia na FIRMA. É uma forma de guardar a informação para consultas futuras e ainda ajudar quem está passando pelo mesmo problema agora ou em um futuro distante.
Hoje precisei fazer um monitor no OpManager (a ferramenta de monitoração que utilizamos na firma) que mostrasse o número de sessões VPN ativas no Cisco ASA (Firewall). A idéia é monitorar de uma forma fácil e gráfica quantos usuários estão utilizando a VPN, determinar horários de pico para otimizar a banda de internet, etc."/>



<meta property="og:title" content="Dica: Cisco ASA - Consultar sessões VPN ativas via SNMP" />
<meta property="og:description" content="Olá Homelabers,
Vou começar a postar mais coisas sobre o meu dia-a-dia na FIRMA. É uma forma de guardar a informação para consultas futuras e ainda ajudar quem está passando pelo mesmo problema agora ou em um futuro distante.
Hoje precisei fazer um monitor no OpManager (a ferramenta de monitoração que utilizamos na firma) que mostrasse o número de sessões VPN ativas no Cisco ASA (Firewall). A idéia é monitorar de uma forma fácil e gráfica quantos usuários estão utilizando a VPN, determinar horários de pico para otimizar a banda de internet, etc." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/dica-cisco-asa-consultar-sessoes-vpn-ativas-via-snmp/" />
<meta property="article:published_time" content="2015-10-06T00:06:54+00:00" />
<meta property="article:modified_time" content="2015-10-06T00:06:54+00:00" /><meta property="og:site_name" content="Blog Homelaber Brasil | " />






  </head>
  <body class="">
    <div class="container">
      <header class="header">
  <span class="header__inner">
    <a href="/" class="logo" style="text-decoration: none;">
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367"/>
</svg>
</span>
    <span class="logo__text">Homelaber Brasil</span>
    <span class="logo__cursor"></span>
  
</a>

    <span class="header__right">
      
        <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/archive">arquivo</a></li>
        
      
        
          <li><a href="/sobre">sobre</a></li>
        
      
        
          <li><a href="https://github.com/valdecircarvalho/">github</a></li>
        
      
        
          <li><a href="https://twitter.com/homelaber">@homelaber</a></li>
        
      
      
    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/archive">arquivo</a></li>
      
    
      
        <li><a href="/sobre">sobre</a></li>
      
    
      
        <li><a href="https://github.com/valdecircarvalho/">github</a></li>
      
    
      
        <li><a href="https://twitter.com/homelaber">@homelaber</a></li>
      
    
  </ul>
</nav>

        <span class="menu-trigger">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M0 0h24v24H0z" fill="none"/>
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
          </svg>
        </span>
      
      <span class="theme-toggle">
        <svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>

      </span>
    </span>
  </span>
</header>


      <div class="content">
        
  <div class="post">
    <h2 class="post-title"><a href="/dica-cisco-asa-consultar-sessoes-vpn-ativas-via-snmp/">Dica: Cisco ASA - Consultar sessões VPN ativas via SNMP</a></h2>
    <div class="post-meta">
      
        <span class="post-date">
            06-10-2015
        </span>
      
      <span class="post-author">— Written by Valdecir Carvalho</span>
      
        <span class="post-read-time">— 2 min lendo</span>
      
    </div>

    
      <span class="post-tags">
        
          #<a href="/tags/blog-vmware/">blog vmware</a>&nbsp;
        
          #<a href="/tags/cisco-asa/">Cisco ASA</a>&nbsp;
        
          #<a href="/tags/dicas/">Dicas</a>&nbsp;
        
          #<a href="/tags/homelab/">homelab</a>&nbsp;
        
          #<a href="/tags/how-to/">how-to</a>&nbsp;
        
          #<a href="/tags/manageengine/">ManageEngine</a>&nbsp;
        
          #<a href="/tags/mib/">MIB</a>&nbsp;
        
          #<a href="/tags/monitora%C3%A7%C3%A3o/">Monitoração</a>&nbsp;
        
          #<a href="/tags/na-firma/">NA FIRMA</a>&nbsp;
        
          #<a href="/tags/oid/">OID</a>&nbsp;
        
          #<a href="/tags/opmanager/">OpManager</a>&nbsp;
        
          #<a href="/tags/snmp/">SNMP</a>&nbsp;
        
          #<a href="/tags/vpn/">VPN</a>&nbsp;
        
      </span>
    

    

    <div class="post-content">
      <p>Olá Homelabers,</p>
<p>Vou começar a postar mais coisas sobre o meu dia-a-dia na FIRMA. É uma forma de guardar a informação para consultas futuras e ainda ajudar quem está passando pelo mesmo problema agora ou em um futuro distante.</p>
<!-- raw HTML omitted -->
<p>Hoje precisei fazer um monitor no <a href="https://www.manageengine.com/network-monitoring/">OpManager</a> (a ferramenta de monitoração que utilizamos na firma) que mostrasse o número de sessões VPN ativas no Cisco ASA (Firewall). A idéia é monitorar de uma forma fácil e gráfica quantos usuários estão utilizando a VPN, determinar horários de pico para otimizar a banda de internet, etc.</p>
<p>No ASA para apresentar essa informação utilizamos o comando:</p>
<pre><code>sh vpn-sessiondb summary
</code></pre>
<p><img src="/imagens/2015/10/cisco-asa-sh-vpn-sessiondb-summary.png" alt="cisco-asa-sh-vpn-sessiondb-summary"></p>
<p>Depois de muito quebrar a cabeça, descobri que a OID SNMP que retorna essa informação é a &ldquo;<strong>.1.3.6.1.4.1.9.9.392.1.3.1</strong>&rdquo; ou &ldquo;crasNumSessions&rdquo; e que a MIB onde está localizada essa informação é a CISCO-REMOTE-ACCESS-MONITOR-MIB (que pode ser baixada <a href="http://tools.cisco.com/Support/SNMP/do/BrowseMIB.do?local=en&amp;step=2&amp;submitClicked=true&amp;mibName=CISCO-REMOTE-ACCESS-MONITOR-MIB#dependencies">aqui no site da Cisco</a>). Vale lembrar que essa OID funciona tanto no OPManager quanto em outras ferramentas de monitoração como o Cacit, Zabbix, etc.</p>
<p>Por fim, foi só importar as MIBs no OpManager, criar um novo monitor e voilá: Um gráfico bonitinho com o número de usuários VPN ativos.</p>
<p><img src="/imagens/2015/10/vpn-sessions-opmanager.png" alt="vpn-sessions-opmanager"></p>
<p>É isso ai pessoal! Se essa informação foi útil para você, deixe um comentário no post!</p>
<p>Edit: Vou deixar o<a href="http://1drv.ms/1j1AVlX"> link do meu One Drive com todas as MIBs do Cisco ASA para Download</a>. Assim, caso eu ou você precisar novamente, não precisaremos ficar &ldquo;caçando&rdquo; pela internet.</p>

    </div>
    
      
        <div class="pagination">
          <div class="pagination__title">
            <span class="pagination__title-h">Leia outros posts</span>
            <hr />
          </div>
          <div class="pagination__buttons">
            
              <span class="button previous">
                <a href="/sessoes-do-vmworld-2015-disponiveis-on-line/">
                  <span class="button__icon">←</span>
                  <span class="button__text">Sessões do VMworld 2015 disponíveis on-line</span>
                </a>
              </span>
            
            
              <span class="button next">
                <a href="/vforum-brasil-2015/">
                  <span class="button__text">vFORUM Brasil 2015</span>
                  <span class="button__icon">→</span>
                </a>
              </span>
            
          </div>
        </div>
      
    
    

    
      
        

      
    
    
    </div>

      </div>

      
        <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright copyright--user">2016-2019 - Homelaber Brasil - Valdecir Carvalho</div>
    
  </div>
</footer>

<script src="/assets/main.js"></script>
<script src="/assets/prism.js"></script>


      
    </div>

    
  </body>
</html>
